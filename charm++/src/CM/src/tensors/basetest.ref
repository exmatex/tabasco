a
           1           2           3

b
           5           6           7

A
           1           2           3
           4           5           6
           7           8           9

B = dyadic(a,b)
           5           6           7
          10          12          14
          15          18          21

C = dyadic(b,a)
           5          10          15
           6          12          18
           7          14          21

sym(C) 
           5           8          11
           8          12          16
          11          16          21

skew(C) 
           0           2           4
          -2           0           2
          -4          -2           0

sym(C) + skew(C) 
           5          10          15
           6          12          18
           7          14          21

B*C
         110         220         330
         220         440         660
         330         660         990

trace(A)         1540
dev(A) 
     -403.33         220         330
         220     -73.333         660
         330         660      476.67

F
           2           0         0.5
        -0.3           1         0.5
           0        -0.2         0.8

inv(F)
      0.4918   -0.054645    -0.27322
     0.13115     0.87432    -0.62842
    0.032787     0.21858      1.0929

F*inv(F)
           1           0           0
   1.587e-17           1  8.0773e-18
           0           0           1

polar decomposition F=RU
R
     0.97661    0.078516     0.20016
    -0.14924     0.91771     0.36816
    -0.15478    -0.38942     0.90796

U
       1.998    -0.11828     0.28987
    -0.11828     0.99559     0.18657
     0.28987     0.18657      1.0105

R.U
           2  2.3315e-16         0.5
        -0.3           1         0.5
 -4.6566e-16        -0.2         0.8

eigen values of U: 2.0809 1.1744 0.74883

spectral composition (should be U)
       1.998    -0.11828     0.28987
    -0.11828     0.99559     0.18657
     0.28987     0.18657      1.0105

R*U*Rt (=V)
      2.0533    -0.11439     0.14442
    -0.11439      1.1466     0.11099
     0.14442     0.11099     0.80425

Ft*F (general mult)
        4.09        -0.3        0.85
        -0.3        1.04        0.34
        0.85        0.34        1.14

C=Ft*F (multAtA)
        4.09        -0.3        0.85
        -0.3        1.04        0.34
        0.85        0.34        1.14

C=square(U)
        4.09        -0.3        0.85
        -0.3        1.04        0.34
        0.85        0.34        1.14

polar decomposition F=VR
R
     0.97661    0.078516     0.20016
    -0.14924     0.91771     0.36816
    -0.15478    -0.38942     0.90796

V
      2.0533    -0.11439     0.14442
    -0.11439      1.1466     0.11099
     0.14442     0.11099     0.80425

V.R
           2  2.2948e-16         0.5
        -0.3           1         0.5
 -4.6453e-16        -0.2         0.8

Rt*V*R (=U)
       1.998    -0.11828     0.28987
    -0.11828     0.99559     0.18657
     0.28987     0.18657      1.0105

log(V)
     0.70035    -0.07673     0.10286
    -0.07673     0.11149    0.094398
     0.10286    0.094398    -0.17347

C
           400             0             0
             0        0.9999   0.009998333
             0   0.009998333  0.0001999867

roots
U
            20             0             0
             0      0.999901  0.0098993396
             0  0.0098993396   0.010098999

U_inv
          0.05             0             0
             0     1.0098997   -0.98993377
             0   -0.98993377      99.99008

F(Rigid rotation -90 degrees
           0          -1           0
           1           0           0
           0           0           1

R
           0          -1           0
           1           0           0
           0           0           1

U
           1           0           0
           0           1           0
           0           0           1

R.U
           0          -1           0
           1           0           0
           0           0           1

log(U)
           0           0           0
           0           0           0
           0           0           0

sig(0)
           0           1           0
           1           0           0
           0           0           0

rotated stress sig(45) = Q*sig(0)*Qt
sig(45)
           1           0           0
           0          -1           0
           0           0           0

E4 = 2G H + (K-2G/3)II
  2.6923e+05           0           0           0  1.1538e+05           0           0           0  1.1538e+05
           0  1.5385e+05           0           0           0           0           0           0           0
           0           0  1.5385e+05           0           0           0           0           0           0
           0           0           0  1.5385e+05           0           0           0           0           0
  1.1538e+05           0           0           0  2.6923e+05           0           0           0  1.1538e+05
           0           0           0           0           0  1.5385e+05           0           0           0
           0           0           0           0           0           0  1.5385e+05           0           0
           0           0           0           0           0           0           0  1.5385e+05           0
  1.1538e+05           0           0           0  1.1538e+05           0           0           0  2.6923e+05

eps
       0.001       0.002       0.004
       0.002     -0.0003      -0.015
       0.004      -0.015     -0.0003

sigma 1 = E4*eps
         200      307.69      615.38
      307.69 -2.0435e-15     -2307.7
      615.38     -2307.7   -2.04e-15

sigma 2 = 2G*dev(eps) + K trace(eps)
         200      307.69      615.38
      307.69           0     -2307.7
      615.38     -2307.7           0

E4 symmetric
  2.6923e+05  1.1538e+05  1.1538e+05           0           0           0
  1.1538e+05  2.6923e+05  1.1538e+05           0           0           0
  1.1538e+05  1.1538e+05  2.6923e+05           0           0           0
           0           0           0       76923           0           0
           0           0           0           0       76923           0
           0           0           0           0           0       76923

eps symmetric
       0.001       0.002       0.004
       0.002     -0.0003      -0.015
       0.004      -0.015     -0.0003

sigma symmetric 1
         200      307.69      615.38
      307.69  5.1591e-15     -2307.7
      615.38     -2307.7  4.7878e-15

sigma symmetric 2
         200      307.69      615.38
      307.69           0     -2307.7
      615.38     -2307.7           0

sigma symmetric 3
         200      307.69      615.38
      307.69 -2.0435e-15     -2307.7
      615.38     -2307.7   -2.04e-15

double contractions
sigma:sigma   1.1638e+07
sigmas:sigmas 1.1638e+07
sigma:sigmas  1.1638e+07

filled symmetric 4th order tensor E4s
  2.6923e+05  1.1538e+05  1.1538e+05         140         170         175
  1.1538e+05  2.6923e+05  1.1538e+05         150         145         185
  1.1538e+05  1.1538e+05  2.6923e+05         160         155         130
         140         150         160       76923         165         140
         170         145         155         165       76923         150
         175         185         130         140         150       76923

symmetric mult
      196.86      303.91      611.53
      303.91       -2.27     -2305.8
      611.53     -2305.8       -2.97

nonsymmetric mult E4*eps
      196.86      303.91      611.53
      303.91       -2.27     -2305.8
      611.53     -2305.8       -2.97

nonsymmetric mult eps*E4
      196.86      303.91      611.53
      303.91       -2.27     -2305.8
      611.53     -2305.8       -2.97

vector product
     0.70711     0.70711           0

    -0.70711     0.70711           0

           0          -0           1

eigenvalues epss    0.0018909    0.014851   -0.016342

invariants epss                  0.0004 -0.00024551 -4.5891e-07
invariants via eigenvalues       0.0004 -0.00024551 -4.5891e-07

second invariant as: 0.5( trace(A)^2 - trace(A^2) )  -0.00024551

check conversion to and from fortan style vector and matrix

epss as tensor
       0.001       0.002       0.004
       0.002     -0.0003      -0.015
       0.004      -0.015     -0.0003

epss as vector (shear * sqrt(2))
       0.001      -0.0003      -0.0003    0.0028284    -0.021213    0.0056569 

and put as tensor again
       0.001       0.002       0.004
       0.002     -0.0003      -0.015
       0.004      -0.015     -0.0003

E4s as tensor
  2.6923e+05  1.1538e+05  1.1538e+05         140         170         175
  1.1538e+05  2.6923e+05  1.1538e+05         150         145         185
  1.1538e+05  1.1538e+05  2.6923e+05         160         155         130
         140         150         160       76923         165         140
         170         145         155         165       76923         150
         175         185         130         140         150       76923

E4s as matrix (shear/normal * sqrt(2), shear/shear * 2)
  2.6923e+05   1.1538e+05   1.1538e+05       197.99       240.42       247.49 
  1.1538e+05   2.6923e+05   1.1538e+05       212.13       205.06       261.63 
  1.1538e+05   1.1538e+05   2.6923e+05       226.27        219.2       183.85 
      197.99       212.13       226.27   1.5385e+05          330          280 
      240.42       205.06        219.2          330   1.5385e+05          300 
      247.49       261.63       183.85          280          300   1.5385e+05 

and put as tensor again
  2.6923e+05  1.1538e+05  1.1538e+05         140         170         175
  1.1538e+05  2.6923e+05  1.1538e+05         150         145         185
  1.1538e+05  1.1538e+05  2.6923e+05         160         155         130
         140         150         160       76923         165         140
         170         145         155         165       76923         150
         175         185         130         140         150       76923

and put as Tensor4LSym
  2.6923e+05  1.1538e+05  1.1538e+05         140         170         175
  1.1538e+05  2.6923e+05  1.1538e+05         150         145         185
  1.1538e+05  1.1538e+05  2.6923e+05         160         155         130
         140         150         160       76923         165         140
         170         145         155         165       76923         150
         175         185         130         140         150       76923

Tensor4LSym put as matrix (shear/normal * sqrt(2), shear/shear * 2)
  2.6923e+05   1.1538e+05   1.1538e+05       197.99       240.42       247.49 
  1.1538e+05   2.6923e+05   1.1538e+05       212.13       205.06       261.63 
  1.1538e+05   1.1538e+05   2.6923e+05       226.27        219.2       183.85 
      197.99       212.13       226.27   1.5385e+05          330          280 
      240.42       205.06        219.2          330   1.5385e+05          300 
      247.49       261.63       183.85          280          300   1.5385e+05 

